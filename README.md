# üßÆ Fine-tuned Qwen Math Solver

–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–ª–∏—è–Ω–∏—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –∏ –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏ Qwen –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π [[2]]

---

## üìÅ Project Structure

.
‚îú‚îÄ‚îÄ data/ # Training & evaluation datasets
‚îÇ ‚îú‚îÄ‚îÄ data_from_latex.csv
‚îÇ ‚îú‚îÄ‚îÄ english_diffeq_dataset_big.csv.zip # Large differential equations dataset
‚îÇ ‚îî‚îÄ‚îÄ test_data.csv
‚îÇ
‚îú‚îÄ‚îÄ models/
‚îÇ ‚îî‚îÄ‚îÄ qwen_math_finetuned/ # Fine-tuned model weights
‚îÇ
‚îú‚îÄ‚îÄ scripts/
‚îÇ ‚îú‚îÄ‚îÄ generate_data_from_latex.py
‚îÇ ‚îú‚îÄ‚îÄ Qwen_tuning.py # Model fine-tuning 

‚îÇ ‚îú‚îÄ‚îÄ quantize.py # Model quantization
‚îÇ ‚îú‚îÄ‚îÄ use_quantized_model.py
‚îÇ ‚îî‚îÄ‚îÄ quantize_and_test.py
‚îÇ
‚îú‚îÄ‚îÄ examples/
‚îÇ ‚îî‚îÄ‚îÄ Using_qwen_for_eq_solution.py
‚îÇ
‚îî‚îÄ‚îÄ metrics/
‚îî‚îÄ‚îÄ get_metrics_from_model_solution.py
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞
```bash
python scripts/generate_data_from_latex.py
```

### 2. –î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
```bash
python scripts/Qwen_tuning.py
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–≤–∞–Ω—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
```bash
python scripts/quantize_and_test.py
```

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —É—Ä–∞–≤–Ω–µ–Ω–∏–π
```bash
python scripts/use_quantized_model.py "–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: x^2 - 5x + 6 = 0"
```

### 5. –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞
```bash
python scripts/get_metrics_from_model_solution.py
```

---

## –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|
| `Qwen_tuning.py` | –î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä–µ—à–µ–Ω–∏—è—Ö –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π  |
| `quantize.py` | –ö–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏  |
| `quantize_and_test.py` | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ 4-–±–∏—Ç–Ω–æ–π –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏–∏ –∏ –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ |
| `use_quantized_model.py` | –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –∫–≤–∞–Ω—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ —Å –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏ |
| `get_metrics_from_model_solution.py` | –û—Ü–µ–Ω–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Ä–µ—à–µ–Ω–∏—è —É—Ä–∞–≤–Ω–µ–Ω–∏–π |

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- Python 3.8+ 
- PyTorch 2.0+
- Transformers 4.35+
- PEFT 0.6+
- Bitsandbytes 0.41+

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ú–æ–¥–µ–ª—å –±—ã–ª–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–∏–ø–∞—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π:
- –ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è
- –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è
- –¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è

–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (Accuracy):
- –ë–∞–∑–æ–≤—ã–π Qwen: 62.4% 
- Fine-tuned Qwen: 89.1% 
- –ö–≤–∞–Ω—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è: 88.7% 
```
